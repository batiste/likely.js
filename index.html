<html>
<head>
<title></title>
<link href='http://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet' type='text/css'>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
<style>

body {
  padding:20px 20px 80px 20px;
  font-family:sans-serif;
  font-size:16px;
  color:#333;
  padding-bottom:300px;
}

h1, h2, h3 {
  font-family: 'Roboto', sans-serif;
  font-weight:400;
}

button {
  padding:10px;
}

textarea {
  font-size:16px;
  font-family:'Ubuntu Mono', monospace, "Courier New", Courier;
  color:#000;
}

#resulth * {
  -moz-animation-duration: 3s;
  -webkit-animation-duration: 3s;
  -moz-animation-name: slidein;
  -webkit-animation-name: slidein;
}

@-moz-keyframes slidein {
  from {
    background:#47a447;
  }

  to {
    background:#fff;
  }
}

@-webkit-keyframes slidein {
  from {
    background:#47a447;
  }

  to {
    background:#fff;
  }
}

</style>
</head>
<body>

<div class="container">
  <div class="header">

  <div class="jumbotron">
    <h1>Likely.js template library</h1>
    <p class="lead">Likely.js is a python inspired templating language for HTML generation. Likely.js offers 
      efficient HTML diff, and bidirectional data binding.</p>
    <p>
      <a class="btn btn-lg btn-success" href="https://github.com/batiste/likely.js" role="button">On github <span class="glyphicon glyphicon-download"></span></a>
      <a href="testsuite.html" class="btn btn-lg btn-success">Test suite <span class="glyphicon glyphicon-th-list"></span></a>
    </p>
  </div>

<h2>Feature highlights</h2>

<ol>
  <li>A simple but powerfull template and expression engine similar to Liquid/Django/Mustache template.</li>
  <li>Bidirectional data binding to ANY JavaScript object.</li>
  <li>Smart html diff that updates the DOM (no innerHTML is used to change the DOM).</li>
</ol>

<div class="row">
<div class="col-md-6">

<h2>Template syntax example</h2>

<p>A change in the template change only what is necessary</p>

<textarea id="template" spellcheck="false" class="form-control" rows="10">
p
  "Filter"
  input value={{ searchTerm }} class="form-control"
hr
for key, value in list
  if searchTerm in value
    p
      {{ key }}
      input value={{ value }} class="form-control"</textarea>

</div>
<div class="col-md-6">

<h2>Data used to render the template</h2>

<p>A change in the data change only what is necessary</p>

<textarea id="data" class="form-control" rows="10" spellcheck="false">
{
  "list":{
    "Email":"test@example.com",
    "Firstname":"Charles",
    "Lastname":"Darwin"
  },
  "searchTerm":""
}
</textarea><br>

</div>
</div>

<div id='errors' class="alert alert-danger" style="display:none"></div>

<h2>Rendered result</h2>
<div id="resulth">
</div>

<h2>Html output</h2>
<pre id="result">
</pre>


<h2>Documentation</h2>

<h3>Flow control</h3>

<h4>For loop</h4>

<p>Iterate over an object or array. Syntax: </p>
<pre><strong>for</strong> [key,] value <strong>in</strong> iterable
  "{{ key }} : {{ value }}"
</pre>

<h4>If / Elseif / Else</h4>

<p>Conditions. Syntax: </p>
<pre><strong>if</strong> espression
  "something"
<strong>elseif</strong> expression
  "something else"
<strong>else</strong>
  "otherwise"
</pre>

<h2>Generating HTML</h2>

<p>Any line starting by an alphabetical letter will produce an HTMl node, e.g.</p>

<pre>ul
  li
    a href="/"
      "Home"
</pre>

<p>Will produce</p>

<pre>&lt;ul&gt;&lt;li&gt;&lt;a href="/"&gt;Home&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</pre>

<h2>Expression</h2>

<p>Expressions can be used in if/else if, in HTML attributes, inside strings or simply as
standalone nodes.</p>

<pre>
h1
  "Expression as node "
  <strong>{{ value }}</strong>
if <strong>value > 10</strong>
  "<strong>{{ value }}</strong> is bigger than 10"
else
  "Please enter a value bigger than 10"
  input value="<strong>{{ value }}</strong>"</pre>
</pre>

<h3>Math</h3>

<pre>p
  {{ 1 + 2 * 2 }}</pre>

<pre>&lt;p&gt;5&lt;/p&gt;</pre>

<h3>In operator</h3>

<pre>{{ "a" <strong>in</strong> "hallo" }}</pre>

<pre>true</pre>

<h3>If operator</h3>

<pre>p class="{{ 'selected' <strong>if</strong> key == selected }}"</pre>

<pre>&lt;p class="selected"&gt;&lt;/p&gt;</pre>

<h3>Filter operator</h3>

<p>The filter operator passe the left value to a function available in the 
current Context.

<pre>var data = {classname: "Selected", lowercase: 
  function(value, context){
    return v.toLowerCase();
  }
};</pre>

<pre>p class="{{ classname <strong>|</strong> lowercase }}"</pre>

<pre>&lt;p class="selected"&gt;&lt;/p&gt;</pre>

</div>
</div>

<script src="likely.js"></script>
<script src="jsonfn.js"></script>


<script>

function get(id) { return document.getElementById(id); }

var r = get("result");
var rh = get("resulth");
var tpl = get("template");
var d = get("data");
var errors = get("errors");
var t, render;

var data = JSONfn.parse(d.value);
var currentTemplate = likely.Template(tpl.value);

var component = new likely.Component(rh, currentTemplate, data);
r.innerHTML = likely.escape(rh.innerHTML);

rh.addEventListener("dataViewChanged", function() {
  d.value = JSONfn.stringify(data);
  r.innerHTML = likely.escape(rh.innerHTML);
});

tpl.onkeyup = logErrors(function(){
  component.template = likely.Template(tpl.value);
  component.update();
  r.innerHTML = likely.escape(rh.innerHTML);
});
d.onkeyup = logErrors(function(){
  data = JSONfn.parse(d.value);
  component.data = data;
  component.update();
  r.innerHTML = likely.escape(rh.innerHTML);
});

function logErrors(fct) {
  return function() {
    errors.style.display = 'none';
    try {
      return fct();
    } catch(e) {
      errors.innerHTML = e.toString();
      errors.style.display = 'block';
      throw e;
    }
  };
}



</script>
