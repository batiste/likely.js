<html>
<head>
<title>Likely.js - tests?</title>
<style>

body {
  padding:20px 20px 80px 20px;
  font-family:sans-serif;
}

h1, h2 {  
  font-family: 'Roboto', sans-serif;
  font-weight:300;
}

button {
  padding:10px;
}

</style>
</head>
<body>

<script language="likely-template" id="tpl1">
table
  tr
    th 
      "Amount"
    th 
      "Price"
    th 
      "Total"
  for line in lines
    tr data-partial="true" id="id-{{ forIndex }}"
      td 
        input type="text" value="{{ line.amount }}"
      td 
        {{ line.price }}
      td 
        {{ line.price * line.amount }}
</script>

<div id="products">

</div>

<script src="likely.js"></script>
<script src="like.js"></script>

<script>

function get(id) { return document.getElementById(id); }

var tpl1 = get("tpl1").innerHTML;
var tpl1c = likely.Template(tpl1);
var products = {
  lines:[
    {desc: "Blue T-Shirt", amount:2, price:25.5},
    {desc: "Green T-Shirt", amount:4, price:24},
    {desc: "Hipster pants", amount:1, price:60}
  ]
};

var productsDom = get("products");
var context = likely.Context(products);

tpl1c.renderTo(context, productsDom);

productsDom.addEventListener("keyup", function(event) {
  var target = event.target || event.srcElement;
  if(target.getAttribute("data-path")) {
    // update the data
    likely.updateData(products, target);
    console.log(products);
  }
});


productsDom.addEventListener("change", function(event) {
  var target = event.target || event.srcElement;
  if(target.getAttribute("data-path")) {
    var context = likely.Context(products);
    tpl1c.renderTo(context, productsDom, true);
  }
});



</script>
